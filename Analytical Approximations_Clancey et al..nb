(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84676,       1994]
NotebookOptionsPosition[     77751,       1874]
NotebookOutlinePosition[     78244,       1892]
CellTagsIndexPosition[     78201,       1889]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Unraveling Adaptive Evolutionary Divergence at Microgeographic Scales\
\>", "Title",
 CellChangeTimes->{{3.855835304403694*^9, 3.85583530516374*^9}, {
   3.85583535515056*^9, 3.8558353637974377`*^9}, 3.8649068323408737`*^9, {
   3.8691565350511503`*^9, 
   3.8691565386943398`*^9}},ExpressionUUID->"9fd47ff8-23e8-4fee-8d63-\
6ad50fb11b65"],

Cell["Supporting File for Clancey et al. ", "Subtitle",
 CellChangeTimes->{{3.855835369848187*^9, 
  3.855835391382304*^9}},ExpressionUUID->"515c3e0d-bdbb-41be-9903-\
20defaec964b"],

Cell["\<\
Here we derive the equations in the appendix corresponding to the analytical \
model for phenotypic change.  Our analytical model follows the life cycle \
presented in Figure 1 in the main text.

Throughout we will use z[i] to denote the phenotype of individuals within \
habitat i and Z[i] to denote the average within population i.  Below we begin \
derive the recursion equation for the the mean phenotype in each habitat, \
solve for the mean phenotype at equilibrium and express the divergence \
between the mean phenotype in the two habitats.\
\>", "Text",
 CellChangeTimes->{{3.855835459736339*^9, 3.855835498637814*^9}, {
  3.8558359164562817`*^9, 3.855836000297681*^9}, {3.8691567332286572`*^9, 
  3.869156753792869*^9}},ExpressionUUID->"cfa925de-fe8c-451c-aaf7-\
3e4bc38e58fa"],

Cell[TextData[{
 StyleBox["Assumptions:  ",
  FontWeight->"Bold"],
 "We want to assume that selection is weak and that habitat selection is \
weak.  To ensure that selection is weak (even on migrants) we have to assume \
that and individual\[CloseCurlyQuote]s phenotype, z , is close to the \
phenotypic optimum in both population 1 AND in population 2. This means that \
(z-\[Theta][1])=O(\[Epsilon]) and (z-\[Theta][2])=O(\[Epsilon]).  To ensure \
that both of these are true, we let ",
 Cell[BoxData[
  RowBox[{"\[Theta]", "=", 
   FractionBox[
    RowBox[{
     RowBox[{"\[Theta]", "[", "2", "]"}], "+", 
     RowBox[{"\[Theta]", "[", "1", "]"}]}], "2"]}]],
  CellChangeTimes->{{3.860617507900751*^9, 3.86061753265164*^9}, {
   3.860677342016451*^9, 3.8606773610610456`*^9}, {3.860679893600169*^9, 
   3.860679988253663*^9}, {3.8606801020285892`*^9, 3.860680107213708*^9}, {
   3.860680193703959*^9, 3.860680223714718*^9}},ExpressionUUID->
  "976d31f8-9e81-4194-b9ed-00620824bd1e"],
 ", the mean of the optima.  We then can insure that selection is always weak \
(not just within a single population but between populations) by letting that \
the deviation of an individuals phenotype from the average optima be ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[Delta]z", " ", "\[Epsilon]"}], "=", 
   RowBox[{"(", 
    RowBox[{"z", "-", "\[Theta]"}], ")"}]}]],
  CellChangeTimes->{{3.860617507900751*^9, 3.86061753265164*^9}, {
    3.860677342016451*^9, 3.8606773610610456`*^9}, {3.860679893600169*^9, 
    3.860679988253663*^9}, {3.8606801020285892`*^9, 3.860680107213708*^9}, {
    3.860680193703959*^9, 3.860680223714718*^9}, 3.860681790250504*^9},
  ExpressionUUID->"d0d297be-d9a6-491c-a6de-ba9a6c8ce27b"],
 " and that the distance between the two optima be  ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"\[Delta]\[Theta]", " ", "\[Epsilon]"}], "=", 
   RowBox[{
    RowBox[{"\[Theta]", "[", "2", "]"}], "-", 
    RowBox[{"\[Theta]", "[", "1", "]"}]}]}]],
  CellChangeTimes->{{3.860617507900751*^9, 3.86061753265164*^9}, {
    3.860677342016451*^9, 3.8606773610610456`*^9}, {3.860679893600169*^9, 
    3.860679988253663*^9}, {3.8606801020285892`*^9, 3.860680107213708*^9}, {
    3.860680193703959*^9, 3.860680223714718*^9}, 3.860681790250504*^9},
  ExpressionUUID->"05c7d7a2-4499-4dd6-ac5b-e52c05a72bf6"],
 " where \[Epsilon] is small.  We us the following substitutions throughout:"
}], "Text",
 CellChangeTimes->{{3.8606814007261*^9, 3.860681524517157*^9}, {
  3.860681612725377*^9, 3.860681979620495*^9}, {3.860682016617929*^9, 
  3.860682051889637*^9}, {3.869156578601192*^9, 3.869156670482363*^9}, {
  3.8691567018944297`*^9, 
  3.869156712530654*^9}},ExpressionUUID->"254cb9f0-9f41-4c78-93a0-\
b34b7a6b8b5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zSub", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", "\[Rule]", 
      RowBox[{"\[Theta]", "+", 
       RowBox[{"\[Delta]z", " ", "\[Epsilon]"}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "1", "]"}], "\[Rule]", 
      RowBox[{"\[Theta]", "-", 
       RowBox[{
        FractionBox["\[Delta]\[Theta]", "2"], "\[Epsilon]"}]}]}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "2", "]"}], "\[Rule]", 
      RowBox[{"\[Theta]", "+", 
       RowBox[{
        FractionBox["\[Delta]\[Theta]", "2"], "\[Epsilon]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Z", "[", 
       RowBox[{"1", ",", "t"}], "]"}], "\[Rule]", 
      RowBox[{"\[Theta]", "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"\[Delta]Z", "[", 
         RowBox[{"1", ",", "t"}], "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"Z", "[", 
       RowBox[{"2", ",", "t"}], "]"}], "\[Rule]", 
      RowBox[{"\[Theta]", "+", 
       RowBox[{"\[Epsilon]", " ", 
        RowBox[{"\[Delta]Z", "[", 
         RowBox[{"2", ",", "t"}], "]"}]}]}]}], ",", 
     RowBox[{"Vz", "\[Rule]", " ", 
      RowBox[{"Vz", " ", 
       SuperscriptBox["\[Epsilon]", "2"]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.860613974245777*^9, 3.8606139891999073`*^9}, {
   3.860617392770623*^9, 3.860617457368473*^9}, {3.860617590747143*^9, 
   3.8606175946691437`*^9}, {3.860618560735241*^9, 3.860618562504546*^9}, {
   3.860676838725555*^9, 3.860676841081956*^9}, {3.8606772711746283`*^9, 
   3.860677296899736*^9}, {3.8606792198049307`*^9, 3.860679224971525*^9}, {
   3.8606795520151567`*^9, 3.860679553433442*^9}, {3.8606798246262074`*^9, 
   3.860679826558579*^9}, {3.869914502778957*^9, 3.86991451292927*^9}, {
   3.869923597422077*^9, 3.869923597874845*^9}, 3.869935846008395*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"40d681a2-6b4c-4f2a-b5d7-f3ffdd2769e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"zSubRev", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Delta]z", "\[Rule]", 
      FractionBox[
       RowBox[{"z", "-", 
        FractionBox[
         RowBox[{
          RowBox[{"\[Theta]", "[", "2", "]"}], "+", 
          RowBox[{"\[Theta]", "[", "1", "]"}]}], "2"]}], "\[Epsilon]"]}], ",", 
     RowBox[{
      RowBox[{"\[Delta]Z", "[", 
       RowBox[{"1", ",", "t"}], "]"}], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"Z", "[", 
         RowBox[{"1", ",", "t"}], "]"}], "-", 
        FractionBox[
         RowBox[{
          RowBox[{"\[Theta]", "[", "2", "]"}], "+", 
          RowBox[{"\[Theta]", "[", "1", "]"}]}], "2"]}], "\[Epsilon]"]}], ",", 
     RowBox[{
      RowBox[{"\[Delta]Z", "[", 
       RowBox[{"2", ",", "t"}], "]"}], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"Z", "[", 
         RowBox[{"2", ",", "t"}], "]"}], "-", 
        FractionBox[
         RowBox[{
          RowBox[{"\[Theta]", "[", "2", "]"}], "+", 
          RowBox[{"\[Theta]", "[", "1", "]"}]}], "2"]}], "\[Epsilon]"]}], ",", 
     RowBox[{"\[Delta]\[Theta]", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"\[Theta]", "[", "2", "]"}], "-", 
        RowBox[{"\[Theta]", "[", "1", "]"}]}], "\[Epsilon]"]}], ",", 
     RowBox[{"\[Theta]", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"\[Theta]", "[", "2", "]"}], "+", 
        RowBox[{"\[Theta]", "[", "1", "]"}]}], "2"]}], ",", 
     RowBox[{"Vz", "\[Rule]", " ", 
      FractionBox["Vz", 
       SuperscriptBox["\[Epsilon]", "2"]]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.860617507900751*^9, 3.86061753265164*^9}, {
   3.860677342016451*^9, 3.8606773610610456`*^9}, {3.860679893600169*^9, 
   3.860679988253663*^9}, {3.8606801020285892`*^9, 3.860680107213708*^9}, {
   3.860680193703959*^9, 3.860680223714718*^9}, 3.860681790250504*^9, {
   3.869914556218759*^9, 3.8699145685261793`*^9}, {3.869923614654645*^9, 
   3.869923615988289*^9}, 3.869935848614432*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"c8f43902-dda2-4dd1-b319-d63dae6331ec"],

Cell[CellGroupData[{

Cell["Mating and Reproduction", "Section",
 CellChangeTimes->{{3.855835539388989*^9, 3.855835540218295*^9}, {
  3.8691503407668543`*^9, 
  3.8691503436698017`*^9}},ExpressionUUID->"81bcf081-6355-4cf9-8d2e-\
f634bfc51f17"],

Cell["\<\
The probability a female with phenotype zF mates with a male with phenotype \
zM is given by:\
\>", "Text",
 CellChangeTimes->{{3.8558360350753393`*^9, 3.855836060773423*^9}, {
  3.869156878811818*^9, 3.8691568808534737`*^9}, {3.8691571151895976`*^9, 
  3.8691571160258293`*^9}},ExpressionUUID->"a3a3a949-8420-446e-a301-\
f42b1134f568"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pmate", "[", 
   RowBox[{"zF_", ",", "zM_"}], "]"}], ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{
    RowBox[{"-", "\[Alpha]"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"zM", "-", "zF", "-", "\[Delta]"}], ")"}], "2"]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8558356431650352`*^9, 3.8558356822394753`*^9}, {
  3.855925548215008*^9, 3.855925548237422*^9}, {3.8691567841632347`*^9, 
  3.869156784803713*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"01ae6596-886c-4b48-9cf5-c0b6567875bc"],

Cell["\<\
In the analytical model we assume that there is no assortative mating \
\[Alpha]=0. \
\>", "Text",
 CellChangeTimes->{{3.855835759593843*^9, 
  3.855835780718074*^9}},ExpressionUUID->"5cfab980-daf1-4896-bd63-\
5b9742ba2fe1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Pmate", "[", 
   RowBox[{"zF", ",", "zM"}], "]"}], "/.", 
  RowBox[{"\[Alpha]", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.855835692911055*^9, 3.855835696324461*^9}, {
  3.85583574686438*^9, 3.8558357539018106`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"c52744b7-19c6-4746-b01e-8caa2c6df42d"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.8558357482652884`*^9, 3.855835754308107*^9}, 
   3.855836341208239*^9, 3.855920845593081*^9, 3.855922724915051*^9, 
   3.855923871580243*^9, 3.855924111012495*^9, 3.8559241711408997`*^9, 
   3.855925551030425*^9, 3.855935494787621*^9, 3.855948392490736*^9, 
   3.8559513428198977`*^9, {3.855951383473137*^9, 3.855951400092058*^9}, 
   3.8562624095816936`*^9, 3.8605852515445757`*^9, 3.8605891426368732`*^9, 
   3.8605935470702257`*^9, 3.8605941141472054`*^9, 3.860613889825501*^9, 
   3.860682356743609*^9, 3.862478014380886*^9, 3.862482126035137*^9, 
   3.8691503540262156`*^9, 3.8691503958055267`*^9, 3.8691505729146285`*^9, 
   3.8691508702384233`*^9, 3.86915392027304*^9, 3.869156210510888*^9, 
   3.869157120275931*^9, 3.869157217859149*^9, 3.869157925802949*^9, 
   3.8691586465672827`*^9, {3.8692320396692023`*^9, 3.8692320779130583`*^9}, 
   3.869232280777297*^9, 3.8692332206510086`*^9, 3.869233467193972*^9, 
   3.8692341295949855`*^9, 3.869759961530199*^9, 3.869770289656537*^9, 
   3.869914518464192*^9, 3.869914572990385*^9, 3.869923620292633*^9, 
   3.8699357491425667`*^9, 3.869937624039966*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"8c2d4cca-10f4-4ed1-8ee2-b50f06db88c3"]
}, Open  ]],

Cell["\<\
As a result the mean phenotype does not change after mating and reproduction. \
The mean phenotype after reproduction (ZR) is therefore equal to the mean \
phenotype before reproduction (Z).\
\>", "Text",
 CellChangeTimes->{{3.8558357906451387`*^9, 3.855835915204109*^9}, {
  3.855836007220108*^9, 3.855836008231667*^9}, {3.860589151196897*^9, 
  3.860589152075897*^9}, {3.869156930168797*^9, 
  3.869156952377452*^9}},ExpressionUUID->"a32c60d2-01ba-4926-ae6b-\
e33d0ad3b588"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ZR", "[", 
   RowBox[{"i_", ",", "t_"}], "]"}], ":=", 
  RowBox[{"Z", "[", 
   RowBox[{"i", ",", "t"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.855835877685251*^9, 3.8558358887051086`*^9}, {
   3.8558360108214607`*^9, 3.85583601347585*^9}, 3.860587819289997*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"21974ee5-f777-45f3-9be2-531fad89523a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Phenotype-dependent Dispersal", "Section",
 CellChangeTimes->{{3.860617711656472*^9, 3.8606177126974783`*^9}, {
  3.864906959636656*^9, 3.8649069606914015`*^9}, {3.869156967267172*^9, 
  3.8691569746115017`*^9}},ExpressionUUID->"b2f9a8bc-069e-4c54-9ae6-\
c2811fa3d8a4"],

Cell["\<\
The probability that an individual with phenotype z migrates from habitat j \
to habitat i is given by:\
\>", "Text",
 CellChangeTimes->{{3.855836020227602*^9, 3.8558360277861147`*^9}, {
  3.8558360638050947`*^9, 
  3.855836110428891*^9}},ExpressionUUID->"4d62278e-dcd7-4ffb-8e4f-\
3ee0c10f1eb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Pmig", "[", 
   RowBox[{"i_", ",", "j_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"2", " ", "m", " ", 
   RowBox[{"H", "[", "i", "]"}], " ", 
   FractionBox[
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "\[Eta]"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z", "-", 
         RowBox[{"\[Theta]", "[", "i", "]"}]}], ")"}], "2"]}], "]"}], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "\[Eta]"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z", "-", 
           RowBox[{"\[Theta]", "[", "k", "]"}]}], ")"}], "2"]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}]]}]}]], "Input",
 CellChangeTimes->{{3.855836076347012*^9, 3.8558361915658617`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"fd1bb678-260b-4f90-8244-3388e8f3e1b0"],

Cell[BoxData[{Cell["\<\

The mean phenotype in population i after migration (ZM) is given by the \
following integral where fzR[i,z] is the probability density of individuals \
with phenotype z in population i after reproduction.   \
\>", "Text",
  CellChangeTimes->{{3.860682096776568*^9, 3.860682182539617*^9}},
  ExpressionUUID->
  "28505fd0-421a-4c8f-aabd-c35e4b3af9d2"], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZM", "[", 
   RowBox[{"i_", ",", "t_"}], "]"}], "=", 
  RowBox[{
   FractionBox["1", "\[ScriptCapitalC]"], 
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Integral]", "\[Infinity]"], 
     RowBox[{"-", "\[Infinity]"}]], 
    RowBox[{"z", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"fzR", "[", 
         RowBox[{"i", ",", "z"}], "]"}], " ", 
        RowBox[{"N", "[", "i", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Pmig", "[", 
           RowBox[{"j", ",", "i", ",", "z"}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"fzR", "[", 
         RowBox[{"j", ",", "z"}], "]"}], " ", 
        RowBox[{"N", "[", "j", "]"}], 
        RowBox[{"Pmig", "[", 
         RowBox[{"i", ",", "j", ",", "z"}], "]"}]}]}], ")"}], " ", 
     "dz"}]}]}]}]}], "Text",
 CellChangeTimes->{{3.855836734209332*^9, 3.855836787639673*^9}, {
   3.855836819012815*^9, 3.85583685181443*^9}, {3.855836883611307*^9, 
   3.8558370961944437`*^9}, {3.8558372078914213`*^9, 3.8558372090576963`*^9}, 
   3.860587844710382*^9, {3.860682083122867*^9, 3.860682093831942*^9}, {
   3.860682185824377*^9, 3.860682191415092*^9}, {3.8691504329117794`*^9, 
   3.869150437350149*^9}, 3.869157101880144*^9, {3.869157160015729*^9, 
   3.8691571876679735`*^9}, {3.8691572779056273`*^9, 
   3.8691572881571383`*^9}},ExpressionUUID->"dbc9e4e5-eff9-43a2-98f1-\
0a8af786f0bf"],

Cell[TextData[{
 "The argument in parentheses is the relative probability density of \
individuals of phenotype ",
 Cell[BoxData[
  FormBox["z", TraditionalForm]],ExpressionUUID->
  "d199e294-0bb9-4e3e-a18c-70116872d770"],
 " in population ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "6a160cbc-db18-4c54-bada-e585897fbc93"],
 " after migration.  Here \[ScriptCapitalC] is a normalization constant that \
normalizes this distribution to have an area of 1.  \n\nWe can rewrite the \
integral as the sum of three integrals\n",
 Cell[BoxData[
  RowBox[{
   RowBox[{"ZM", "[", 
    RowBox[{"1", ",", "t"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox["\[Integral]", "\[Infinity]"], 
      RowBox[{"-", "\[Infinity]"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z", " ", 
        RowBox[{"fR", "[", 
         RowBox[{"1", ",", "z"}], "]"}], " ", 
        RowBox[{"NH", "[", "1", "]"}]}], ")"}], " ", "dz"}]}], " ", "+", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["\[Integral]", "\[Infinity]"], 
      RowBox[{"-", "\[Infinity]"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "z"}], " ", 
        RowBox[{"fR", "[", 
         RowBox[{"1", ",", "z"}], "]"}], " ", 
        RowBox[{"NH", "[", "1", "]"}], " ", 
        RowBox[{"Pmig", "[", 
         RowBox[{"2", ",", "1", ",", "z"}], "]"}]}], ")"}], "dz"}]}], "+", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["\[Integral]", "\[Infinity]"], 
      RowBox[{"-", "\[Infinity]"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"z", " ", 
        RowBox[{"fR", "[", 
         RowBox[{"2", ",", "z"}], "]"}], " ", "N", " ", 
        RowBox[{"H", "[", "2", "]"}], 
        RowBox[{"Pmig", "[", 
         RowBox[{"1", ",", "2", ",", "z"}], "]"}]}], ")"}], "  ", 
      "dz"}]}]}]}]],
  CellChangeTimes->{{3.855836734209332*^9, 3.855836787639673*^9}, {
   3.855836819012815*^9, 3.85583685181443*^9}, {3.855836883611307*^9, 
   3.8558370961944437`*^9}, {3.8558372078914213`*^9, 3.8558372090576963`*^9}},
  ExpressionUUID->"5bb540ba-283a-46d3-9101-adc973c264fa"]
}], "Text",
 CellChangeTimes->{{3.855837099429405*^9, 3.855837218658854*^9}, {
  3.85583726379222*^9, 3.855837288825767*^9}, {3.855837325806616*^9, 
  3.8558375268875437`*^9}, {3.855838877295253*^9, 3.8558388825352*^9}, {
  3.8559200729564543`*^9, 3.855920076535722*^9}, {3.860587848443591*^9, 
  3.860587848444161*^9}, {3.8605914429543037`*^9, 3.860591444247547*^9}, {
  3.860591769306223*^9, 3.8605917748413754`*^9}, {3.860682193822338*^9, 
  3.860682197107296*^9}, {3.8691504466472564`*^9, 
  3.8691504576775885`*^9}},ExpressionUUID->"ec8c6608-19f2-4dc3-b386-\
7e0e41188392"],

Cell[TextData[{
 "By integrating the distribution fzR[i] over z gives an expectation:   ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox["\[Integral]", "\[Infinity]"], 
      RowBox[{"-", "\[Infinity]"}]], 
     RowBox[{
      RowBox[{"fzR", "[", 
       RowBox[{"i", ",", "z"}], "]"}], " ", "A", " ", "dz"}]}], "=", 
    RowBox[{
     SubscriptBox["E", 
      SubscriptBox["z1", "i"]], "[", "A", "]"}], " "}], TraditionalForm]],
  ExpressionUUID->"14769ffe-8e6d-47d5-ac2c-efccf7d5d434"],
 ".  We can perform such an expectation in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " by substituting ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["z", "2"], TraditionalForm]],ExpressionUUID->
  "2d43b12c-c21e-4198-a0d7-ae918cfe9fcc"],
 " for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"ZR", "[", 
      RowBox[{"i", ",", "t"}], "]"}], "2"], "+", 
    SubscriptBox["V", "z"]}], TraditionalForm]],ExpressionUUID->
  "dd898473-fb12-4eb7-8127-2e6336016f5e"],
 " where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["V", "z"], TraditionalForm]],ExpressionUUID->
  "de660b4e-545a-4d95-b35c-febc33d6f26f"],
 " is the phenotypic variance in habitat ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "9d962750-d1f0-483b-af7b-1d79182381b5"],
 " (note we assume the phenotypic variance is equal in both habitats) and z \
for ZR[i,t].  Note that like the genetic variance we will assume the the \
phenotypic variance remains constant throughout.  "
}], "Text",
 CellChangeTimes->{{3.855837533098403*^9, 3.855837711051787*^9}, {
  3.855837751250786*^9, 3.85583777119551*^9}, {3.855920235031155*^9, 
  3.8559203118036127`*^9}, {3.8559203961375103`*^9, 3.855920505819528*^9}, {
  3.855920570415194*^9, 3.855920593296948*^9}, {3.855920719305151*^9, 
  3.855920755522037*^9}, {3.856262380123321*^9, 3.856262391180702*^9}, {
  3.860591798422893*^9, 3.860591823057756*^9}, {3.860591862048601*^9, 
  3.860591862253543*^9}, {3.860613828802519*^9, 3.8606138290393887`*^9}, {
  3.860682200185832*^9, 3.860682202710458*^9}, {3.869157338924797*^9, 
  3.8691573436413727`*^9}},ExpressionUUID->"4122ba44-c0ba-4da0-a20f-\
e54447dde248"],

Cell[CellGroupData[{

Cell["The Un-normalized Change", "Subsection",
 CellChangeTimes->{{3.855950881062605*^9, 
  3.855950897036647*^9}},ExpressionUUID->"a40212d4-f35a-4379-8d76-\
d8d99f23eab0"],

Cell["\<\
We are going to work out the integrals for the change in the phenotype in \
population 1.  We will then generalize the result to an arbitrary population\
\>", "Text",
 CellChangeTimes->{{3.860614121504768*^9, 
  3.860614177805833*^9}},ExpressionUUID->"cc9004f2-343d-4925-a729-\
24c81a5fb54f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"int1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"z", " ", "N", " ", 
            RowBox[{"H", "[", "1", "]"}]}], "/.", "zSub"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], 
       "/.", "zSubRev"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "m"}], "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["z", "2"], "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"ZR", "[", 
          RowBox[{"1", ",", "t"}], "]"}], "2"], "+", "Vz"}]}], ",", 
      RowBox[{"z", "\[Rule]", 
       RowBox[{"ZR", "[", 
        RowBox[{"1", ",", "t"}], "]"}]}]}], "}"}]}], "//", 
   "Factor"}]}]], "Input",
 CellChangeTimes->{{3.854289438155428*^9, 3.854289461601054*^9}, {
   3.854289500480811*^9, 3.854289502433422*^9}, {3.8553386400441103`*^9, 
   3.855338640556737*^9}, {3.855338802960917*^9, 3.855338830657381*^9}, {
   3.8553404490470257`*^9, 3.855340450331009*^9}, {3.8553404894559717`*^9, 
   3.855340489589163*^9}, {3.8553405523228827`*^9, 3.855340627833802*^9}, {
   3.8558374984947433`*^9, 3.855837499351392*^9}, {3.8558377145433607`*^9, 
   3.8558377465335817`*^9}, 3.855838096435316*^9, {3.85584827753395*^9, 
   3.855848278992293*^9}, 3.855848501319504*^9, {3.855848658411862*^9, 
   3.8558486624596148`*^9}, 3.8558488236999893`*^9, 3.855920325983385*^9, {
   3.855920388825205*^9, 3.855920389922393*^9}, 3.855936497225122*^9, {
   3.855936565630492*^9, 3.8559365721911373`*^9}, {3.8559484032015944`*^9, 
   3.855948404437001*^9}, {3.855950188266368*^9, 3.8559501976711617`*^9}, 
   3.860585548098267*^9, 3.8605855895386667`*^9, {3.860589170558926*^9, 
   3.860589177029848*^9}, 3.860593736225113*^9, {3.86061385739802*^9, 
   3.8606138690895443`*^9}, {3.8606139967680483`*^9, 
   3.8606139989950123`*^9}, {3.860614665018549*^9, 3.8606146653374443`*^9}, {
   3.860618116740548*^9, 3.860618120605278*^9}, 3.860618352561425*^9, {
   3.860618401480904*^9, 3.860618402541718*^9}, {3.869150245840819*^9, 
   3.869150246036186*^9}, {3.86915036875471*^9, 3.8691503689099092`*^9}, {
   3.86915046463689*^9, 3.869150466696393*^9}, 3.869150534030791*^9, {
   3.8691506283792934`*^9, 3.869150628524083*^9}, {3.8691538476132426`*^9, 
   3.8691538501027775`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"6d390819-e168-4c4e-afa0-27bf571d47fb"],

Cell[BoxData[
 RowBox[{"N", " ", 
  RowBox[{"H", "[", "1", "]"}], " ", 
  RowBox[{"Z", "[", 
   RowBox[{"1", ",", "t"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.855837719813623*^9, 3.855837738408535*^9}, 
   3.855837774944729*^9, 3.855838097181943*^9, 3.855848279493639*^9, 
   3.8558485020153313`*^9, 3.855848662824614*^9, 3.85584882402468*^9, 
   3.855920391803577*^9, 3.855920849126865*^9, 3.8559227274713*^9, 
   3.855923173516755*^9, 3.8559238716138268`*^9, 3.855924041119567*^9, 
   3.85592413591184*^9, 3.8559241744304857`*^9, {3.855926032280322*^9, 
   3.855926051867963*^9}, 3.8559354950873938`*^9, 3.8559364980270967`*^9, 
   3.8559365742798243`*^9, {3.855948399454336*^9, 3.855948405309531*^9}, {
   3.855950173049711*^9, 3.855950193073588*^9}, {3.855951327702001*^9, 
   3.855951343049138*^9}, {3.855951378359304*^9, 3.85595140443408*^9}, 
   3.856262414179907*^9, 3.8605856189345627`*^9, 3.860589180575766*^9, 
   3.860589501986186*^9, 3.86059195406176*^9, 3.86059373704592*^9, 
   3.86061387026478*^9, 3.860613901137128*^9, 3.860613999630568*^9, 
   3.8606146655768623`*^9, 3.8606181402097387`*^9, 3.8606183529354258`*^9, 
   3.860618402970014*^9, 3.860618574513103*^9, 3.8606767104331923`*^9, 
   3.860678130851509*^9, 3.860679246957699*^9, 3.8606795997043962`*^9, {
   3.860679868725793*^9, 3.860679876096822*^9}, 3.860679999957749*^9, 
   3.860680045613018*^9, 3.860680111653173*^9, {3.860680212881616*^9, 
   3.8606802296476803`*^9}, 3.8606807646702127`*^9, 3.860682473419557*^9, 
   3.86247801617769*^9, 3.862482127769769*^9, 3.864907044010322*^9, 
   3.8649073107503147`*^9, 3.8677714413185124`*^9, {3.8691502231852193`*^9, 
   3.8691502486479745`*^9}, 3.8691503541319404`*^9, 3.8691503959135227`*^9, 
   3.8691505730371327`*^9, 3.869150870407061*^9, 3.869153887016828*^9, 
   3.869153920424093*^9, 3.8691562106426907`*^9, 3.8691571203786364`*^9, 
   3.8691572179469175`*^9, 3.8691579258966813`*^9, 3.869158646683978*^9, {
   3.8692320397317266`*^9, 3.8692320817790213`*^9}, 3.8692322808616095`*^9, 
   3.8692332207167373`*^9, 3.8692334673345547`*^9, 3.8692341297043357`*^9, 
   3.869759961592717*^9, 3.869770289719534*^9, 3.869914524260166*^9, 
   3.869914575098118*^9, 3.869923624052432*^9, 3.8699357492519746`*^9, 
   3.8699376240986514`*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"8cc114ac-65ca-418a-beb6-97783ab41d1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"int2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "N"}], " ", 
             RowBox[{"H", "[", "1", "]"}], "z", " ", 
             RowBox[{"Pmig", "[", 
              RowBox[{"2", ",", "1", ",", "z"}], "]"}]}], "/.", "zSub"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}],
         "/.", "zSubRev"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "m"}], "}"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", "2"], "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"ZR", "[", 
           RowBox[{"1", ",", "t"}], "]"}], "2"], "+", "Vz"}]}], ",", 
       RowBox[{"z", "\[Rule]", 
        RowBox[{"ZR", "[", 
         RowBox[{"1", ",", "t"}], "]"}]}]}], "}"}]}], "//", "Factor"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.854289438155428*^9, 3.854289461601054*^9}, {
   3.854289500480811*^9, 3.854289502433422*^9}, {3.8553386400441103`*^9, 
   3.855338640556737*^9}, {3.855338802960917*^9, 3.855338830657381*^9}, {
   3.8553404490470257`*^9, 3.855340450331009*^9}, {3.8553404894559717`*^9, 
   3.855340489589163*^9}, {3.8553405523228827`*^9, 3.855340627833802*^9}, {
   3.8558374984947433`*^9, 3.855837499351392*^9}, {3.8558377145433607`*^9, 
   3.855837716365259*^9}, {3.855837779569723*^9, 3.8558378151371613`*^9}, 
   3.855838093399769*^9, {3.855838284426165*^9, 3.855838286449242*^9}, 
   3.855838886945972*^9, 3.855848287054349*^9, {3.855848381957321*^9, 
   3.8558484042078876`*^9}, 3.8558484917966623`*^9, 3.85584882608493*^9, 
   3.855936493984276*^9, 3.85593658065281*^9, {3.8559484086893883`*^9, 
   3.8559484109851513`*^9}, {3.855950202824377*^9, 3.855950203050812*^9}, {
   3.860587899790983*^9, 3.860587902377406*^9}, 3.860589186466424*^9, 
   3.8605939807672863`*^9, {3.860613923411336*^9, 3.8606139335453253`*^9}, {
   3.860614004080554*^9, 3.8606140140055656`*^9}, {3.860614668383803*^9, 
   3.860614668560583*^9}, {3.860618144479731*^9, 3.860618148410885*^9}, 
   3.8606183554594193`*^9, {3.860618398342251*^9, 3.860618399386194*^9}, {
   3.860680128728181*^9, 3.860680129648374*^9}, 3.86068038945186*^9, {
   3.8691502519459105`*^9, 3.869150252146782*^9}, {3.869150371922002*^9, 
   3.869150372046158*^9}, {3.869150470909479*^9, 3.8691504868390956`*^9}, 
   3.869150536779479*^9, {3.869150637236253*^9, 3.869150637347433*^9}, {
   3.869151106953043*^9, 3.869151122730937*^9}, {3.869151217544169*^9, 
   3.869151218213126*^9}, {3.869153852718357*^9, 3.869153854099161*^9}, {
   3.869154308438246*^9, 3.869154331109559*^9}, {3.8691544156250534`*^9, 
   3.8691544179959764`*^9}, {3.8691544893162127`*^9, 3.869154491920425*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"04333801-dc11-460d-9dca-105eec94b88c"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "m", " ", "N", " ", 
  RowBox[{"H", "[", "1", "]"}], " ", 
  RowBox[{"H", "[", "2", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[Eta]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "1", "]"}], "-", 
       RowBox[{"\[Theta]", "[", "2", "]"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "1", "]"}], "+", 
        RowBox[{"\[Theta]", "[", "2", "]"}]}], ")"}], "2"]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"Z", "[", 
      RowBox[{"1", ",", "t"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"\[Eta]", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"\[Theta]", "[", "1", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"\[Theta]", "[", "2", "]"}], "2"]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.855837719813623*^9, {3.8558377822366962`*^9, 3.8558378156841993`*^9}, 
   3.855838098731516*^9, 3.855838290144402*^9, 3.8558388875391817`*^9, 
   3.85584828775167*^9, 3.855848405451378*^9, 3.855848826591631*^9, {
   3.855920826289263*^9, 3.855920850849729*^9}, 3.855922727477044*^9, 
   3.8559231748824797`*^9, 3.85592387163061*^9, 3.855924041125649*^9, 
   3.855924135919038*^9, 3.855924174439312*^9, {3.8559260345427856`*^9, 
   3.8559260529887333`*^9}, 3.855935495105137*^9, 3.855936500096921*^9, 
   3.8559365819098597`*^9, 3.8559484115438766`*^9, 3.8559502039283533`*^9, {
   3.855951327718943*^9, 3.855951343055483*^9}, {3.8559513836963*^9, 
   3.855951404450451*^9}, 3.856262414198023*^9, 3.860585709412067*^9, 
   3.860587903937955*^9, 3.8605891872880983`*^9, 3.860589504100388*^9, 
   3.860591973483266*^9, 3.860593982511413*^9, 3.860613934060912*^9, {
   3.860614004701234*^9, 3.860614037547954*^9}, 3.860614668779875*^9, 
   3.8606181490696373`*^9, 3.8606183563797417`*^9, 3.860618404486266*^9, 
   3.86061858235358*^9, 3.860676741844083*^9, 3.8606768583098507`*^9, 
   3.860678130909679*^9, 3.860679247035925*^9, 3.8606795997270947`*^9, 
   3.860679877315147*^9, 3.860680002242717*^9, 3.860680043417667*^9, {
   3.860680113077816*^9, 3.8606801300462847`*^9}, 3.860680212902626*^9, 
   3.860680324307699*^9, 3.86068039204563*^9, 3.860680765733211*^9, 
   3.860682474749229*^9, 3.8624780161933117`*^9, 3.862482127785383*^9, 
   3.8649070440571876`*^9, 3.8649073108128004`*^9, 3.867771441402851*^9, {
   3.86915022323036*^9, 3.869150253172735*^9}, 3.8691503541804495`*^9, 
   3.869150395960118*^9, 3.869150573097003*^9, 3.869150870470643*^9, 
   3.869151134283388*^9, 3.8691538895714164`*^9, 3.8691539204988627`*^9, 
   3.8691562106900897`*^9, 3.8691571204098825`*^9, 3.8691572179815235`*^9, 
   3.869157925927923*^9, 3.869158646730871*^9, {3.869232039779914*^9, 
   3.8692320819821005`*^9}, 3.8692322809085255`*^9, 3.8692332207619305`*^9, 
   3.8692334673970175`*^9, 3.8692341297503715`*^9, 3.8697599616239266`*^9, 
   3.8697702897508125`*^9, 3.869914524287676*^9, 3.8699145751194267`*^9, 
   3.8699236240828047`*^9, 3.8699357492814283`*^9, 3.8699376241299305`*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"52df1fb4-cc3f-43eb-86e6-c103151cd4d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"int3", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"N", " ", 
             RowBox[{"H", "[", "2", "]"}], "z", " ", 
             RowBox[{"Pmig", "[", 
              RowBox[{"1", ",", "2", ",", "z"}], "]"}]}], "/.", "zSub"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}],
         "/.", "zSubRev"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", "m"}], "}"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", "2"], "\[Rule]", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"ZR", "[", 
           RowBox[{"2", ",", "t"}], "]"}], "2"], "+", "Vz"}]}], ",", 
       RowBox[{"z", "\[Rule]", 
        RowBox[{"ZR", "[", 
         RowBox[{"2", ",", "t"}], "]"}]}]}], "}"}]}], "//", "Factor"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.855837823352487*^9, 3.8558378404697933`*^9}, 
   3.855838092613845*^9, {3.85583827900139*^9, 3.855838281115117*^9}, 
   3.8558482918013573`*^9, 3.855848494796359*^9, 3.8558488284952707`*^9, 
   3.8559364890182467`*^9, {3.8559365860110607`*^9, 3.8559365884599*^9}, {
   3.855948413976982*^9, 3.855948415641366*^9}, {3.855950207010518*^9, 
   3.855950215649815*^9}, {3.860587893715616*^9, 3.8605878971334257`*^9}, 
   3.8605939986554337`*^9, {3.8606140596156607`*^9, 3.860614060889592*^9}, {
   3.860614672412549*^9, 3.860614672582468*^9}, {3.86061815192727*^9, 
   3.8606181558636436`*^9}, 3.8606182390920973`*^9, 3.860618359104578*^9, {
   3.860618408780737*^9, 3.860618409915237*^9}, {3.860677179779776*^9, 
   3.86067718070263*^9}, {3.8691504763970566`*^9, 3.869150484095005*^9}, 
   3.869150539422613*^9, {3.869150653573954*^9, 3.8691506537563453`*^9}, {
   3.869151231827536*^9, 3.8691512322439785`*^9}, {3.8691538566121264`*^9, 
   3.869153858281801*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"5e7c6e71-8be9-4a36-b742-f8ced53719c4"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "m", " ", "N", " ", 
  RowBox[{"H", "[", "1", "]"}], " ", 
  RowBox[{"H", "[", "2", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[Eta]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "1", "]"}], "-", 
       RowBox[{"\[Theta]", "[", "2", "]"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "1", "]"}], "+", 
        RowBox[{"\[Theta]", "[", "2", "]"}]}], ")"}], "2"]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"Z", "[", 
      RowBox[{"2", ",", "t"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"\[Eta]", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"\[Theta]", "[", "1", "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"\[Theta]", "[", "2", "]"}], "2"]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.860618218450239*^9, 3.860618359492276*^9, 3.860618410314931*^9, 
   3.860618585931336*^9, 3.860677117246586*^9, 3.860677181053944*^9, 
   3.860678130967593*^9, 3.860679247081283*^9, 3.860679599737391*^9, 
   3.8606798807395763`*^9, {3.860680004434207*^9, 3.860680040735354*^9}, 
   3.860680146538673*^9, {3.86068019958251*^9, 3.860680212911262*^9}, 
   3.8606805433604937`*^9, 3.860680766469285*^9, 3.8606824763666162`*^9, 
   3.8624780162248354`*^9, 3.8624821278166294`*^9, 3.864907044097868*^9, 
   3.8649073108752856`*^9, 3.867771441464013*^9, 3.869150223256915*^9, 
   3.869150354230115*^9, 3.869150396000023*^9, 3.8691505731535873`*^9, 
   3.869150870530582*^9, {3.8691538924701667`*^9, 3.869153920569816*^9}, 
   3.869156210723443*^9, 3.8691571204462395`*^9, 3.869157218014884*^9, 
   3.8691579259520025`*^9, 3.869158646777733*^9, {3.8692320398111677`*^9, 
   3.8692320820301332`*^9}, 3.869232280958366*^9, 3.869233220818121*^9, 
   3.8692334674595046`*^9, 3.869234129800598*^9, 3.869759961655203*^9, 
   3.8697702944847517`*^9, 3.869914524297943*^9, 3.869914575124661*^9, 
   3.869923624106324*^9, 3.869935749312976*^9, 3.869937624161178*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"1a213e3b-bdec-4880-8865-1013680753a7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Normalizing Constant", "Subsection",
 CellChangeTimes->{{3.855837917825157*^9, 
  3.855837922392494*^9}},ExpressionUUID->"0830dce7-ddbc-4ce6-8ac1-\
78508e617ae3"],

Cell[TextData[{
 "The normalization constant is ",
 Cell[BoxData[
  RowBox[{"\[ScriptCapitalC]", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox["\[Integral]", "\[Infinity]"], 
      RowBox[{"-", "\[Infinity]"}]], 
     RowBox[{
      RowBox[{"fi", "[", 
       RowBox[{"i", ",", "z"}], "]"}], " ", 
      RowBox[{"N", "[", "i", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Pmig", "[", 
         RowBox[{"j", ",", "i", ",", "z"}], "]"}]}], ")"}]}]}], "+", 
    RowBox[{
     RowBox[{"fj", "[", 
      RowBox[{"j", ",", "z"}], "]"}], " ", 
     RowBox[{"N", "[", "j", "]"}], 
     RowBox[{"Pmig", "[", 
      RowBox[{"i", ",", "j", ",", "z"}], "]"}], "dz"}]}]}]],
  CellChangeTimes->{{3.855836734209332*^9, 3.855836787639673*^9}, {
   3.855836819012815*^9, 3.85583685181443*^9}, {3.855836883611307*^9, 
   3.8558370961944437`*^9}, {3.8558372078914213`*^9, 3.8558372090576963`*^9}},
  ExpressionUUID->"401cad06-f285-4bc3-8f94-7c02c132cd83"],
 ".  As with the integral above we can rewrite this as the sum of three \
integrals.\n\n",
 Cell[BoxData[
  RowBox[{"\[ScriptCapitalC]", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox["\[Integral]", "\[Infinity]"], 
      RowBox[{"-", "\[Infinity]"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f1", "[", 
         RowBox[{"1", ",", "z"}], "]"}], " ", "N", " ", 
        RowBox[{"H", "[", "1", "]"}]}], ")"}], " ", "dz"}]}], " ", "+", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["\[Integral]", "\[Infinity]"], 
      RowBox[{"-", "\[Infinity]"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"f1", "[", 
          RowBox[{"1", ",", "z"}], "]"}]}], " ", "N", " ", 
        RowBox[{"H", "[", "1", "]"}], " ", 
        RowBox[{"Pmig", "[", 
         RowBox[{"2", ",", "1", ",", "z"}], "]"}]}], ")"}], "dz"}]}], "+", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["\[Integral]", "\[Infinity]"], 
      RowBox[{"-", "\[Infinity]"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f1", "[", 
         RowBox[{"2", ",", "z"}], "]"}], " ", "N", " ", 
        RowBox[{"H", "[", "2", "]"}], 
        RowBox[{"Pmig", "[", 
         RowBox[{"1", ",", "2", ",", "z"}], "]"}]}], ")"}], "  ", 
      "dz"}]}]}]}]],
  CellChangeTimes->{{3.855836734209332*^9, 3.855836787639673*^9}, {
   3.855836819012815*^9, 3.85583685181443*^9}, {3.855836883611307*^9, 
   3.8558370961944437`*^9}, {3.8558372078914213`*^9, 3.8558372090576963`*^9}},
  ExpressionUUID->"394f962e-2871-476e-a3f9-76a64a7c731a"]
}], "Text",
 CellChangeTimes->{{3.855837927319702*^9, 3.855838011721406*^9}, {
  3.855838860901256*^9, 3.855838865260015*^9}, {3.869150491613858*^9, 
  3.869150506426819*^9}, {3.869157412449019*^9, 
  3.8691574158622217`*^9}},ExpressionUUID->"e11d214a-2722-458a-bb19-\
7f50ee5eeec6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"intC1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"N", " ", 
            RowBox[{"H", "[", "1", "]"}]}], "/.", "zSub"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], 
       "/.", "zSubRev"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "m"}], "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["z", "2"], "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"ZR", "[", 
          RowBox[{"1", ",", "t"}], "]"}], "2"], "+", "Vz"}]}], ",", 
      RowBox[{"z", "\[Rule]", 
       RowBox[{"ZR", "[", 
        RowBox[{"1", ",", "t"}], "]"}]}]}], "}"}]}], "//", 
   "Factor"}]}]], "Input",
 CellChangeTimes->{{3.854289438155428*^9, 3.854289461601054*^9}, {
   3.854289500480811*^9, 3.854289502433422*^9}, {3.8553386400441103`*^9, 
   3.855338640556737*^9}, {3.855338802960917*^9, 3.855338830657381*^9}, {
   3.8553404490470257`*^9, 3.855340450331009*^9}, {3.8553404894559717`*^9, 
   3.855340489589163*^9}, {3.8553405523228827`*^9, 3.855340627833802*^9}, {
   3.8558374984947433`*^9, 3.855837499351392*^9}, {3.8558377145433607`*^9, 
   3.8558377465335817`*^9}, {3.8558380239154053`*^9, 3.855838037640066*^9}, 
   3.8558380897319717`*^9, {3.855848307529566*^9, 3.8558483104702883`*^9}, 
   3.855848540959689*^9, 3.855848835490727*^9, 3.85593648311695*^9, 
   3.855936597844013*^9, {3.855948421943912*^9, 3.8559484236310472`*^9}, 
   3.855950240966764*^9, 3.860589196991139*^9, {3.860614076204504*^9, 
   3.860614077348894*^9}, {3.860614645284498*^9, 3.8606146455527554`*^9}, 
   3.8606182509264603`*^9, {3.860618417076353*^9, 3.860618437803597*^9}, {
   3.869150508955941*^9, 3.869150525534154*^9}, {3.8691538636833677`*^9, 
   3.869153865268819*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"7563f4e0-4622-4ec1-807a-f3dbff4af3c4"],

Cell[BoxData[
 RowBox[{"N", " ", 
  RowBox[{"H", "[", "1", "]"}]}]], "Output",
 CellChangeTimes->{{3.855837719813623*^9, 3.855837738408535*^9}, 
   3.855837774944729*^9, 3.855838048650289*^9, 3.855838103685442*^9, 
   3.855838296055127*^9, 3.85584831094785*^9, 3.8558485471984453`*^9, 
   3.855848836033832*^9, 3.855920902090073*^9, 3.85592272749339*^9, 
   3.855923181526738*^9, 3.8559238716579647`*^9, 3.855924041166641*^9, 
   3.855924135949506*^9, 3.85592417448346*^9, 3.855926060051086*^9, 
   3.855935495154594*^9, {3.8559365189747667`*^9, 3.855936539514947*^9}, 
   3.855936618935295*^9, 3.8559484243939734`*^9, 3.855950246780787*^9, {
   3.855951327745969*^9, 3.8559513430864353`*^9}, {3.85595138371523*^9, 
   3.855951404471521*^9}, 3.85626241421972*^9, 3.860585832131073*^9, 
   3.860587927402688*^9, 3.860589197783348*^9, 3.860614078508135*^9, 
   3.86061464587848*^9, 3.860618257425211*^9, {3.86061841825982*^9, 
   3.860618438172439*^9}, 3.8606185986537*^9, 3.860677194549903*^9, 
   3.860678130985957*^9, 3.860679277683383*^9, 3.860679599756543*^9, 
   3.8606802129430523`*^9, 3.86068055054856*^9, 3.860680768779099*^9, 
   3.8606824782502327`*^9, 3.8624780162248354`*^9, 3.8624821278478746`*^9, 
   3.864907044131292*^9, 3.864907310922184*^9, 3.867771441516963*^9, 
   3.86915022328207*^9, 3.8691503542719917`*^9, 3.869150396050683*^9, 
   3.869150573211561*^9, 3.8691508705865774`*^9, {3.8691538964412374`*^9, 
   3.8691539206343613`*^9}, 3.8691562107628727`*^9, 3.8691571204462395`*^9, 
   3.869157218014884*^9, 3.8691579259676237`*^9, 3.8691586468382607`*^9, {
   3.869232039853106*^9, 3.8692320820788603`*^9}, 3.8692322809896154`*^9, 
   3.869233220863469*^9, 3.8692334675219*^9, 3.8692341298545094`*^9, 
   3.8697599616708217`*^9, 3.869770294602639*^9, 3.86991452432154*^9, 
   3.8699145751293507`*^9, 3.869923624112727*^9, 3.8699357493482018`*^9, 
   3.869937624196744*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"4650cf4c-e6ce-4a14-8f09-54b8deb57430"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"intC2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", "N"}], " ", 
            RowBox[{"H", "[", "1", "]"}], 
            RowBox[{"Pmig", "[", 
             RowBox[{"2", ",", "1", ",", "z"}], "]"}]}], "/.", "zSub"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], 
       "/.", "zSubRev"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "m"}], "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["z", "2"], "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"ZR", "[", 
          RowBox[{"1", ",", "t"}], "]"}], "2"], "+", "Vz"}]}], ",", 
      RowBox[{"z", "\[Rule]", 
       RowBox[{"ZR", "[", 
        RowBox[{"1", ",", "t"}], "]"}]}]}], "}"}]}], "//", 
   "Factor"}]}]], "Input",
 CellChangeTimes->{{3.854289438155428*^9, 3.854289461601054*^9}, {
   3.854289500480811*^9, 3.854289502433422*^9}, {3.8553386400441103`*^9, 
   3.855338640556737*^9}, {3.855338802960917*^9, 3.855338830657381*^9}, {
   3.8553404490470257`*^9, 3.855340450331009*^9}, {3.8553404894559717`*^9, 
   3.855340489589163*^9}, {3.8553405523228827`*^9, 3.855340627833802*^9}, {
   3.8558374984947433`*^9, 3.855837499351392*^9}, {3.8558377145433607`*^9, 
   3.855837716365259*^9}, {3.855837779569723*^9, 3.8558378151371613`*^9}, {
   3.8558380251288357`*^9, 3.855838043173059*^9}, {3.855838081539341*^9, 
   3.8558380838759613`*^9}, {3.8558382690989933`*^9, 3.8558382719759407`*^9}, 
   3.855838898714519*^9, 3.855848320263443*^9, 3.8558485439086514`*^9, 
   3.855848838259653*^9, {3.855936438272087*^9, 3.8559364384781523`*^9}, 
   3.85593647888719*^9, 3.855936600387858*^9, {3.855948427522337*^9, 
   3.855948429614822*^9}, 3.855950243101286*^9, {3.8605879120977*^9, 
   3.8605879170229597`*^9}, 3.860592704598793*^9, {3.860614081009763*^9, 
   3.860614082277869*^9}, {3.860614649215867*^9, 3.860614649412621*^9}, 
   3.8606182489799747`*^9, {3.860618421207116*^9, 3.860618442416407*^9}, {
   3.869150521998792*^9, 3.8691505228214397`*^9}, {3.8691506598401184`*^9, 
   3.8691506611582355`*^9}, {3.8691538692197123`*^9, 3.8691538707961655`*^9}},
 
 CellLabel->"In[32]:=",ExpressionUUID->"cfbe3205-2c15-471a-8dc4-4c4bab0d6bbb"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "m", " ", "N", " ", 
  RowBox[{"H", "[", "1", "]"}], " ", 
  RowBox[{"H", "[", "2", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "2"}], "+", 
    RowBox[{"2", " ", "\[Eta]", " ", 
     RowBox[{"Z", "[", 
      RowBox[{"1", ",", "t"}], "]"}], " ", 
     RowBox[{"\[Theta]", "[", "1", "]"}]}], "-", 
    RowBox[{"\[Eta]", " ", 
     SuperscriptBox[
      RowBox[{"\[Theta]", "[", "1", "]"}], "2"]}], "-", 
    RowBox[{"2", " ", "\[Eta]", " ", 
     RowBox[{"Z", "[", 
      RowBox[{"1", ",", "t"}], "]"}], " ", 
     RowBox[{"\[Theta]", "[", "2", "]"}]}], "+", 
    RowBox[{"\[Eta]", " ", 
     SuperscriptBox[
      RowBox[{"\[Theta]", "[", "2", "]"}], "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.855837719813623*^9, {3.8558377822366962`*^9, 3.8558378156841993`*^9}, 
   3.855838049479641*^9, 3.855838104382661*^9, {3.8558382722349567`*^9, 
   3.855838297771427*^9}, 3.8558388993039703`*^9, 3.855848320939603*^9, 
   3.85584854450054*^9, 3.855848838805686*^9, 3.855920903440476*^9, 
   3.855922727511154*^9, 3.8559231829906893`*^9, 3.855923871663069*^9, 
   3.855924041172859*^9, 3.855924135972555*^9, 3.855924174489771*^9, 
   3.8559260612863913`*^9, 3.8559354951601*^9, {3.855936519894574*^9, 
   3.855936540752438*^9}, 3.855936618966764*^9, 3.855948430174819*^9, 
   3.855950247637651*^9, {3.8559513277521343`*^9, 3.855951343111526*^9}, {
   3.8559513837273417`*^9, 3.855951404479333*^9}, 3.8562624142250547`*^9, 
   3.860585833542552*^9, {3.860587926008182*^9, 3.860587928420259*^9}, 
   3.860589203076152*^9, 3.860592705964693*^9, 3.8606140826593533`*^9, 
   3.860614649716433*^9, 3.860618256220727*^9, {3.8606184215722713`*^9, 
   3.86061844288441*^9}, 3.860618600118579*^9, 3.860677196349936*^9, 
   3.860678130996711*^9, 3.860679277723501*^9, 3.8606795997640533`*^9, 
   3.860680212962194*^9, 3.860680551362423*^9, 3.8606807696461163`*^9, 
   3.8606824794313803`*^9, 3.8624780162561164`*^9, 3.8624821278791065`*^9, 
   3.864907044162572*^9, 3.864907310984635*^9, 3.8677714415626955`*^9, 
   3.869150223314087*^9, 3.8691503543221936`*^9, 3.869150396105631*^9, 
   3.86915057328105*^9, 3.86915087064668*^9, {3.869153898802535*^9, 
   3.86915392070313*^9}, 3.869156210811017*^9, 3.869157120477519*^9, 
   3.8691572180461473`*^9, 3.869157925983245*^9, 3.869158646868359*^9, {
   3.8692320399018507`*^9, 3.8692320820820003`*^9}, 3.869232281036483*^9, 
   3.8692332209172754`*^9, 3.8692334675876217`*^9, 3.8692341299004645`*^9, 
   3.8697599616843147`*^9, 3.8697702946338844`*^9, 3.869914524326993*^9, 
   3.869914575139534*^9, 3.869923624120261*^9, 3.869935749353396*^9, 
   3.869937624196744*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"6650ed04-98a8-430d-8ad0-ba585a3fe726"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"intC3", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"N", " ", 
            RowBox[{"H", "[", "2", "]"}], 
            RowBox[{"Pmig", "[", 
             RowBox[{"1", ",", "2", ",", "z"}], "]"}]}], "/.", "zSub"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], 
       "/.", "zSubRev"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "m"}], "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["z", "2"], "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"ZR", "[", 
          RowBox[{"2", ",", "t"}], "]"}], "2"], "+", "Vz"}]}], ",", 
      RowBox[{"z", "\[Rule]", 
       RowBox[{"ZR", "[", 
        RowBox[{"2", ",", "t"}], "]"}]}]}], "}"}]}], "//", 
   "Factor"}]}]], "Input",
 CellChangeTimes->{{3.855837823352487*^9, 3.8558378404697933`*^9}, {
   3.855838027943762*^9, 3.855838045445627*^9}, 3.855838086741329*^9, {
   3.855838262912191*^9, 3.8558382652938643`*^9}, 3.855848323548215*^9, 
   3.8558485564402437`*^9, 3.85584884167712*^9, {3.8559364327406273`*^9, 
   3.8559364328977823`*^9}, 3.85593652359343*^9, {3.855936605562291*^9, 
   3.855936609112236*^9}, {3.855948433798917*^9, 3.855948434968759*^9}, 
   3.8559502440011377`*^9, {3.8605879188046722`*^9, 3.860587922387102*^9}, {
   3.860614085007222*^9, 3.8606140861048183`*^9}, {3.860614652278452*^9, 
   3.860614652477705*^9}, 3.8606182538498383`*^9, {3.860618424804126*^9, 
   3.860618447937458*^9}, {3.8691505505913734`*^9, 3.869150550910158*^9}, {
   3.869150666597418*^9, 3.8691506668084335`*^9}, {3.86915387293123*^9, 
   3.86915387447058*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"c19c3c1d-32b3-49e0-91c1-afff4622a5e7"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "m", " ", "N", " ", 
  RowBox[{"H", "[", "1", "]"}], " ", 
  RowBox[{"H", "[", "2", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{"2", "+", 
    RowBox[{"2", " ", "\[Eta]", " ", 
     RowBox[{"Z", "[", 
      RowBox[{"2", ",", "t"}], "]"}], " ", 
     RowBox[{"\[Theta]", "[", "1", "]"}]}], "-", 
    RowBox[{"\[Eta]", " ", 
     SuperscriptBox[
      RowBox[{"\[Theta]", "[", "1", "]"}], "2"]}], "-", 
    RowBox[{"2", " ", "\[Eta]", " ", 
     RowBox[{"Z", "[", 
      RowBox[{"2", ",", "t"}], "]"}], " ", 
     RowBox[{"\[Theta]", "[", "2", "]"}]}], "+", 
    RowBox[{"\[Eta]", " ", 
     SuperscriptBox[
      RowBox[{"\[Theta]", "[", "2", "]"}], "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.855837841084416*^9, 3.855838050490378*^9, 3.855838105077218*^9, 
   3.855838265615767*^9, 3.855838299188311*^9, 3.8558483241564693`*^9, {
   3.8558485499652233`*^9, 3.8558485570257387`*^9}, 3.855848842244326*^9, 
   3.855920904952795*^9, 3.8559227275298357`*^9, 3.855923184758553*^9, 
   3.855923871668944*^9, 3.8559240411905413`*^9, 3.855924135978463*^9, 
   3.855924174507372*^9, 3.855926062854374*^9, 3.8559354951803513`*^9, {
   3.855936524300805*^9, 3.855936541697959*^9}, 3.855936618973588*^9, 
   3.8559484355481777`*^9, 3.8559502511049337`*^9, {3.8559513277734947`*^9, 
   3.855951343117927*^9}, {3.85595138373391*^9, 3.855951404494897*^9}, 
   3.856262414237132*^9, 3.860585834865666*^9, {3.860587923027234*^9, 
   3.860587929137677*^9}, 3.860589205547059*^9, 3.8606140865088873`*^9, 
   3.860614652710593*^9, 3.8606182543935013`*^9, {3.860618425372603*^9, 
   3.860618448352262*^9}, 3.8606186018991213`*^9, 3.86067719869256*^9, 
   3.86067813101553*^9, 3.8606792777484207`*^9, 3.8606795997825117`*^9, 
   3.860680212969429*^9, {3.860680560583535*^9, 3.8606805682336283`*^9}, 
   3.860680771167186*^9, 3.860682480733053*^9, 3.862478016271735*^9, 
   3.8624821279103274`*^9, 3.864907044215569*^9, 3.864907311036314*^9, 
   3.8677714416038604`*^9, 3.869150223351259*^9, 3.8691503543712826`*^9, 
   3.869150396177812*^9, 3.8691505733695726`*^9, 3.8691508707164345`*^9, {
   3.8691539022928677`*^9, 3.869153920775883*^9}, 3.869156210857498*^9, 
   3.8691571205163937`*^9, 3.8691572180773973`*^9, 3.869157926029428*^9, 
   3.869158646915226*^9, {3.8692320399195833`*^9, 3.8692320821305027`*^9}, 
   3.8692322810791173`*^9, 3.869233220964075*^9, 3.869233467657584*^9, 
   3.8692341299722776`*^9, 3.8697599661183853`*^9, 3.869770294656437*^9, 
   3.869914524349757*^9, 3.869914575157771*^9, 3.869923624137022*^9, 
   3.869935749382507*^9, 3.869937624228024*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"49d09dd9-7ea0-4f31-b7ed-91e45853ae9e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The mean phenotype after dispersal", "Subsection",
 CellChangeTimes->{{3.855950866841568*^9, 3.855950902617683*^9}, {
   3.869157441171528*^9, 3.8691574727854104`*^9}, 
   3.8691577523382893`*^9},ExpressionUUID->"0e581a85-53b7-459f-b760-\
c30f0b167eff"],

Cell["Generalizing to an arbitrary population", "Text",
 CellChangeTimes->{{3.860614210791387*^9, 
  3.8606142182337503`*^9}},ExpressionUUID->"99eb0de2-566c-4876-831b-\
0a87ce8c88eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ZM", "[", 
   RowBox[{"i_", ",", "t_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Factor", "[", 
          FractionBox[
           RowBox[{"int1", "+", "int2", "+", "int3"}], 
           RowBox[{"intC1", "+", "intC2", "+", "intC3"}]], "]"}], "/.", 
         "zSub"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], "/.",
      "zSubRev"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Z", "[", 
        RowBox[{"1", ",", "t"}], "]"}], "\[Rule]", 
       RowBox[{"Z", "[", 
        RowBox[{"i", ",", "t"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Z", "[", 
        RowBox[{"2", ",", "t"}], "]"}], "\[Rule]", 
       RowBox[{"Z", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "2"}], "]"}], "+", "1"}], ",", "t"}], "]"}]}], 
      ",", 
      RowBox[{
       RowBox[{"H", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"H", "[", "i", "]"}]}], ",", 
      RowBox[{
       RowBox[{"H", "[", "2", "]"}], "\[Rule]", 
       RowBox[{"H", "[", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"i", ",", "2"}], "]"}], "+", "1"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "1", "]"}], "\[Rule]", 
       RowBox[{"\[Theta]", "[", "i", "]"}]}], ",", 
      RowBox[{
       RowBox[{"\[Theta]", "[", "2", "]"}], "\[Rule]", 
       RowBox[{"\[Theta]", "[", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"i", ",", "2"}], "]"}], "+", "1"}], "]"}]}]}], "}"}]}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.85584936317188*^9, 3.855849383493675*^9}, 
   3.855849475925539*^9, {3.855849512531199*^9, 3.855849518916328*^9}, {
   3.855936364704179*^9, 3.855936374847726*^9}, {3.85594847916376*^9, 
   3.85594850463212*^9}, {3.8559496439841003`*^9, 3.855949652870735*^9}, 
   3.8559504521633797`*^9, 3.8605879814011507`*^9, {3.8605910390940313`*^9, 
   3.860591075772975*^9}, {3.86061468271894*^9, 3.860614682889414*^9}, {
   3.860616879658543*^9, 3.8606169025177402`*^9}, {3.860677315241271*^9, 
   3.8606773203482523`*^9}, {3.860677370619944*^9, 3.8606773733677263`*^9}, {
   3.860677958138817*^9, 3.8606779583310623`*^9}, 3.860678545010828*^9, 
   3.8606793167979517`*^9, 3.860679367238295*^9, 3.8606794562119417`*^9, 
   3.8606796549086847`*^9, {3.860680583458927*^9, 3.860680584715828*^9}, {
   3.869150706847898*^9, 3.869150707027889*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"c8a67f98-e546-4008-b870-0c7334a12b20"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ZM", "[", 
    RowBox[{"1", ",", "t"}], "]"}], "/.", "zSubRev"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.860679721644012*^9, 3.8606797278318853`*^9}, {
   3.860680610994543*^9, 3.860680611399843*^9}, 3.869157654499368*^9},
 CellLabel->"In[35]:=",ExpressionUUID->"c0f6af99-3d04-4f80-831f-a040330449a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"m", " ", 
      RowBox[{"H", "[", "2", "]"}]}]}], ")"}], " ", 
   RowBox[{"Z", "[", 
    RowBox[{"1", ",", "t"}], "]"}]}], "+", 
  RowBox[{"m", " ", 
   RowBox[{"H", "[", "2", "]"}], " ", 
   RowBox[{"Z", "[", 
    RowBox[{"2", ",", "t"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.860679719637224*^9, 3.86067972813059*^9}, 
   3.860680213066593*^9, {3.860680588152651*^9, 3.8606806116846333`*^9}, 
   3.8606807765913057`*^9, 3.8606824826449003`*^9, 3.8624780163029823`*^9, 
   3.8624821279572296`*^9, 3.8649070442992306`*^9, 3.8649073111300416`*^9, 
   3.8677714417068057`*^9, 3.869150223403347*^9, 3.8691503544851856`*^9, 
   3.86915039626*^9, 3.869150573479952*^9, 3.869150870800708*^9, 
   3.8691539208745904`*^9, 3.869156210922694*^9, 3.8691571205431867`*^9, 
   3.86915721812422*^9, 3.869157929941626*^9, 3.8691586470036182`*^9, {
   3.8692320399664493`*^9, 3.8692320822189355`*^9}, 3.8692322811593585`*^9, 
   3.8692332210116477`*^9, 3.8692334677325025`*^9, 3.8692341300639467`*^9, 
   3.8697599662635345`*^9, 3.8697702947080317`*^9, 3.869914524376753*^9, 
   3.869914575168775*^9, 3.869923624160666*^9, 3.8699357494297113`*^9, 
   3.869937624259268*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"d7d9db62-8e6e-4ff4-a041-8d1692fac34d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ZM", "[", 
    RowBox[{"2", ",", "t"}], "]"}], "/.", "zSubRev"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.869937678529143*^9, 3.869937681544983*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"def35405-e5e3-4e82-b220-bd15e8dcd81f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", " ", 
   RowBox[{"H", "[", "1", "]"}], " ", 
   RowBox[{"Z", "[", 
    RowBox[{"1", ",", "t"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"m", " ", 
      RowBox[{"H", "[", "1", "]"}]}]}], ")"}], " ", 
   RowBox[{"Z", "[", 
    RowBox[{"2", ",", "t"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.8699376828434258`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"d9084b66-cfb2-49f6-af2d-84470b923806"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Selection", "Section",
 CellChangeTimes->{{3.860680649490404*^9, 
  3.860680650525547*^9}},ExpressionUUID->"24526be6-f3bd-4f8a-9c9b-\
35d9772bcde7"],

Cell[TextData[{
 "The change in the mean phenotype due to selection is given by Lande 1976 \
Equation 7. ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]Z", "=", 
    RowBox[{"G", 
     FractionBox["1", 
      OverscriptBox["W", "_"]], 
     FractionBox["d", "dZ"], 
     OverscriptBox["W", "_"]}]}], TraditionalForm]],ExpressionUUID->
  "7cfc089c-c3c8-4f75-b452-52c5a6cc5874"],
 " where ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["W", "_"], TraditionalForm]],ExpressionUUID->
  "adad0067-3e0a-4513-8d87-80931cbf7b3f"],
 " is the average fitness"
}], "Text",
 CellChangeTimes->{{3.855920971555428*^9, 3.855921007065703*^9}, {
  3.855948609280314*^9, 3.8559486562388563`*^9}, {3.8559509720565033`*^9, 
  3.8559509758803167`*^9}, {3.855951017301917*^9, 
  3.8559510190785847`*^9}},ExpressionUUID->"317157d1-dc81-47bf-984b-\
a2d1835b9a0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"W", "[", 
   RowBox[{"z_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{
    RowBox[{"-", "\[Gamma]"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"z", "-", 
       RowBox[{"\[Theta]", "[", "i", "]"}]}], ")"}], "2"]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.855921066000423*^9, 3.855921083670804*^9}, {
   3.8559211210290213`*^9, 3.855921148596294*^9}, 3.8691577029373474`*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"e6deb151-7301-41b0-bd64-9346fba5dfff"],

Cell["\<\
Let Y[i,t] be the mean phenotype after migration.  We are going to use this \
as a stand-in until we want to plug in the full expression from above.\
\>", "Text",
 CellChangeTimes->{{3.8606153927032547`*^9, 
  3.860615440373453*^9}},ExpressionUUID->"de41c51d-d8b4-4513-833e-\
eb8c922fc3e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Wavg", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Expand", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"W", "[", 
            RowBox[{"z", ",", "i"}], "]"}], "/.", "zSub"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], 
       "/.", "zSubRev"}], "/.", 
      RowBox[{"Z", "\[Rule]", 
       RowBox[{"Y", "[", 
        RowBox[{"i", ",", "t"}], "]"}]}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["z", "2"], "\[Rule]", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"Y", "[", 
          RowBox[{"i", ",", "t"}], "]"}], "2"], "+", "Vz"}]}], ",", 
      RowBox[{"z", "\[Rule]", 
       RowBox[{"Y", "[", 
        RowBox[{"i", ",", "t"}], "]"}]}]}], "}"}]}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.855926170976722*^9, 3.8559262806074467`*^9}, {
   3.855926920969092*^9, 3.8559269492918043`*^9}, {3.8559510639471073`*^9, 
   3.855951078278906*^9}, {3.856265647308065*^9, 3.8562656715669622`*^9}, {
   3.8562657899398003`*^9, 3.856265791916827*^9}, 3.860586649684966*^9, {
   3.8605882207115927`*^9, 3.860588256733285*^9}, {3.860588431916601*^9, 
   3.860588439137072*^9}, {3.8606152508105993`*^9, 3.860615264760503*^9}, {
   3.860680839531057*^9, 3.860680844232066*^9}, {3.8606811436882877`*^9, 
   3.8606811459120007`*^9}, {3.8691507582160125`*^9, 3.869150758359623*^9}, {
   3.8691576185176067`*^9, 3.869157634139614*^9}, {3.8692320428906336`*^9, 
   3.869232087877803*^9}, {3.869233267236662*^9, 3.869233276239593*^9}, 
   3.86923350126643*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"1187aa29-b908-4dda-93a7-7ecd604c93c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"G", 
  RowBox[{"(", 
   FractionBox[
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Wavg", "[", "1", "]"}], ",", 
      RowBox[{"Y", "[", 
       RowBox[{"1", ",", "t"}], "]"}]}], "]"}], 
    RowBox[{"Wavg", "[", "1", "]"}]], ")"}]}]], "Input",
 CellChangeTimes->{{3.860681114930505*^9, 3.860681160449938*^9}, {
  3.8691576449477196`*^9, 3.869157646608073*^9}, {3.8692322237990227`*^9, 
  3.869232229947859*^9}, {3.8692322886368513`*^9, 3.8692322936860013`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"a6f6d314-b47e-4b3c-a9fe-dac0c2dbedbc"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", "G", " ", "\[Gamma]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Y", "[", 
       RowBox[{"1", ",", "t"}], "]"}], "-", 
      RowBox[{"\[Theta]", "[", "1", "]"}]}], ")"}]}], 
   RowBox[{"1", "-", 
    RowBox[{"Vz", " ", "\[Gamma]"}], "-", 
    RowBox[{"\[Gamma]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Y", "[", 
         RowBox[{"1", ",", "t"}], "]"}], "-", 
        RowBox[{"\[Theta]", "[", "1", "]"}]}], ")"}], "2"]}]}]]}]], "Output",
 CellChangeTimes->{
  3.8606811607678967`*^9, 3.860682443544518*^9, 3.860682490177599*^9, 
   3.862478016506054*^9, 3.8624821281606026`*^9, 3.864907044517962*^9, 
   3.8649073113490686`*^9, 3.8677714419525795`*^9, 3.8691502235425863`*^9, 
   3.869150354553566*^9, 3.8691503963766613`*^9, 3.8691505736923027`*^9, 
   3.869150871126091*^9, 3.8691539210573816`*^9, 3.869156211034261*^9, 
   3.8691571205900545`*^9, 3.8691572181968603`*^9, 3.8691577605940623`*^9, 
   3.8691579301568346`*^9, 3.869158647097313*^9, 3.8692314381593943`*^9, {
   3.8692320400662527`*^9, 3.869232082316733*^9}, 3.8692322314796104`*^9, {
   3.869232281933096*^9, 3.8692322947518206`*^9}, 3.869233221117195*^9, 
   3.869233280267702*^9, 3.869233467905309*^9, 3.869233505945258*^9, 
   3.8692341301713047`*^9, 3.8697599663884745`*^9, 3.8697702948173637`*^9, 
   3.869914528844658*^9, {3.869914579277893*^9, 3.8699145902184134`*^9}, 
   3.86992362895548*^9, 3.869935749523119*^9, 3.8699376243088093`*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"bf957891-6191-4e21-8d68-b7007c90816b"]
}, Open  ]],

Cell["The phenotype after selection is given by:", "Text",
 CellChangeTimes->{{3.855951023263826*^9, 
  3.855951040926177*^9}},ExpressionUUID->"751a9c22-66cf-47f1-a437-\
6e038df794ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ZS", "[", 
   RowBox[{"i_", ",", "t_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Y", "[", 
           RowBox[{"i", ",", "t"}], "]"}], "+", 
          RowBox[{"G", 
           RowBox[{"(", 
            FractionBox[
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"Wavg", "[", "i", "]"}], ",", 
               RowBox[{"Y", "[", 
                RowBox[{"i", ",", "t"}], "]"}]}], "]"}], 
             RowBox[{"Wavg", "[", "i", "]"}]], ")"}]}]}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Y", "[", 
             RowBox[{"1", ",", "t"}], "]"}], "\[Rule]", 
            RowBox[{"ZM", "[", 
             RowBox[{"1", ",", "t"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"Y", "[", 
             RowBox[{"2", ",", "t"}], "]"}], "\[Rule]", 
            RowBox[{"ZM", "[", 
             RowBox[{"2", ",", "t"}], "]"}]}]}], "}"}]}], "/.", "zSub"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], "/.",
     "zSubRev"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.8605883677893047`*^9, 3.8605883815398903`*^9}, {
   3.8605887907146997`*^9, 3.860588840185266*^9}, {3.860615460260564*^9, 
   3.860615464778994*^9}, {3.8606157343444242`*^9, 3.860615739346695*^9}, {
   3.860616572768396*^9, 3.86061657318671*^9}, 3.86068110165281*^9, {
   3.860681191054503*^9, 3.860681237333012*^9}, {3.869150774496097*^9, 
   3.86915077471909*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"9553856d-b294-49d4-9f47-f9b21a8b518b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ZS", "[", 
  RowBox[{"1", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.8606825000160227`*^9, 3.860682502262245*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"1931cd6f-1ea6-4b8d-97b8-9756dd6b7bed"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", "G", " ", "\[Gamma]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"H", "[", "2", "]"}]}]}], ")"}], " ", 
   RowBox[{"Z", "[", 
    RowBox[{"1", ",", "t"}], "]"}]}], "+", 
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"2", " ", "G", " ", "\[Gamma]"}]}], ")"}], " ", 
   RowBox[{"H", "[", "2", "]"}], " ", 
   RowBox[{"Z", "[", 
    RowBox[{"2", ",", "t"}], "]"}]}], "+", 
  RowBox[{"2", " ", "G", " ", "\[Gamma]", " ", 
   RowBox[{"\[Theta]", "[", "1", "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.86068250263175*^9, 3.8624780165529184`*^9, 3.862482128223119*^9, 
   3.864907044698992*^9, 3.86490731163019*^9, 3.8677714421972027`*^9, 
   3.8691502236515236`*^9, 3.869150354701973*^9, 3.869150396497382*^9, 
   3.8691505739078693`*^9, 3.8691508713314176`*^9, 3.8691539212604227`*^9, 
   3.8691562111179876`*^9, 3.8691571206369133`*^9, 3.8691572182593117`*^9, 
   3.8691579302349405`*^9, 3.8691586472066946`*^9, {3.8692320401292825`*^9, 
   3.8692320823646097`*^9}, 3.8692322820435224`*^9, 3.869233221201551*^9, 
   3.8692334680303397`*^9, 3.8692341302650356`*^9, 3.869759966466611*^9, 
   3.869770294879851*^9, 3.8699145321167297`*^9, {3.8699145793373632`*^9, 
   3.8699145902496147`*^9}, 3.869923628979863*^9, 3.8699357496006975`*^9, 
   3.869937624349318*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"c19f8c1b-f943-4d61-8fe7-0442a6fe9a69"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ZS", "[", 
  RowBox[{"2", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.8699381185038586`*^9, 3.8699381186847963`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"721607fb-305f-4165-8fc6-da3a570dc769"],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"2", " ", "G", " ", "\[Gamma]"}]}], ")"}], " ", 
   RowBox[{"H", "[", "1", "]"}], " ", 
   RowBox[{"Z", "[", 
    RowBox[{"1", ",", "t"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", "G", " ", "\[Gamma]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"m", " ", 
      RowBox[{"H", "[", "1", "]"}]}]}], ")"}], " ", 
   RowBox[{"Z", "[", 
    RowBox[{"2", ",", "t"}], "]"}]}], "+", 
  RowBox[{"2", " ", "G", " ", "\[Gamma]", " ", 
   RowBox[{"\[Theta]", "[", "2", "]"}]}]}]], "Output",
 CellChangeTimes->{3.869938119293646*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"5cae3daa-5b8b-4e8f-afef-fbf16b0d0e70"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equilibrium", "Subsection",
 CellChangeTimes->{{3.860681275465416*^9, 
  3.860681276885235*^9}},ExpressionUUID->"4987b84b-f731-4b72-a9df-\
e4b1c0ea87be"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"equi", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ZS", "[", 
          RowBox[{"1", ",", "t"}], "]"}], ")"}], "\[Equal]", 
        RowBox[{"Z", "[", 
         RowBox[{"1", ",", "t"}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"ZS", "[", 
         RowBox[{"2", ",", "t"}], "]"}], "\[Equal]", 
        RowBox[{"Z", "[", 
         RowBox[{"2", ",", "t"}], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Z", "[", 
        RowBox[{"1", ",", "t"}], "]"}], ",", 
       RowBox[{"Z", "[", 
        RowBox[{"2", ",", "t"}], "]"}]}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.860617127367838*^9, 3.860617219704109*^9}, {
  3.860681284469737*^9, 3.860681308994446*^9}, {3.869939358646763*^9, 
  3.8699393613312583`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"2cd31178-0853-4289-a5e4-7cc4542ec860"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Z", "[", 
      RowBox[{"1", ",", "t"}], "]"}], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "m"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"H", "[", "1", "]"}], " ", 
           RowBox[{"\[Theta]", "[", "1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"H", "[", "2", "]"}], " ", 
           RowBox[{"\[Theta]", "[", "2", "]"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "G", " ", "\[Gamma]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"m", " ", 
              RowBox[{"H", "[", "1", "]"}]}]}], ")"}], " ", 
           RowBox[{"\[Theta]", "[", "1", "]"}]}], "+", 
          RowBox[{"m", " ", 
           RowBox[{"H", "[", "2", "]"}], " ", 
           RowBox[{"\[Theta]", "[", "2", "]"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "m"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"H", "[", "1", "]"}], "+", 
          RowBox[{"H", "[", "2", "]"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "G", " ", "\[Gamma]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"H", "[", "1", "]"}], "+", 
             RowBox[{"H", "[", "2", "]"}]}], ")"}]}]}], ")"}]}]}]]}], ",", 
    RowBox[{
     RowBox[{"Z", "[", 
      RowBox[{"2", ",", "t"}], "]"}], "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "G", " ", "\[Gamma]", " ", 
        RowBox[{"\[Theta]", "[", "2", "]"}]}], "+", 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "G", " ", "\[Gamma]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"H", "[", "1", "]"}], " ", 
           RowBox[{"\[Theta]", "[", "1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"H", "[", "2", "]"}], " ", 
           RowBox[{"\[Theta]", "[", "2", "]"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "m"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"H", "[", "1", "]"}], "+", 
          RowBox[{"H", "[", "2", "]"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "G", " ", "\[Gamma]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"H", "[", "1", "]"}], "+", 
             RowBox[{"H", "[", "2", "]"}]}], ")"}]}]}], ")"}]}]}]]}]}], "}"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.860681300383613*^9, 3.860681309352028*^9}, {
   3.860682440235155*^9, 3.860682443708179*^9}, 3.860682508666419*^9, 
   3.862478016631023*^9, 3.8624821283012266`*^9, 3.8649070448473153`*^9, 
   3.8649073118019934`*^9, 3.867771442389495*^9, 3.8691502238091803`*^9, 
   3.8691503554930325`*^9, 3.8691503966123333`*^9, 3.8691505740938253`*^9, 
   3.8691508714994783`*^9, 3.8691539214525595`*^9, 3.869156211256611*^9, 
   3.8691571206590557`*^9, 3.869157218368661*^9, {3.869157900724434*^9, 
   3.869157930322647*^9}, 3.869158647303935*^9, {3.869232040225871*^9, 
   3.8692320824427176`*^9}, 3.8692322820921946`*^9, 3.8692332212780404`*^9, 
   3.8692334680834217`*^9, 3.869234130349043*^9, 3.8697599665759716`*^9, 
   3.8697702949892015`*^9, 3.8699145350541773`*^9, {3.86991457940279*^9, 
   3.8699145902736053`*^9}, 3.8699236290423193`*^9, 3.8699357496735816`*^9, 
   3.8699376243801804`*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"e48aeaa0-4112-4cfe-8d3b-9be7c1c3587e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Z", "[", 
        RowBox[{"2", ",", "t"}], "]"}], "-", 
       RowBox[{"Z", "[", 
        RowBox[{"1", ",", "t"}], "]"}]}], "/.", 
      RowBox[{"equi", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "/.", "zSub"}], "/.", "zSubRev"}], "/.", 
   RowBox[{
    RowBox[{"H", "[", "1", "]"}], "\[Rule]", 
    RowBox[{"1", "-", 
     RowBox[{"H", "[", "2", "]"}]}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.860681309809656*^9, 3.860681335637542*^9}, 
   3.8697600072041407`*^9, {3.8697600377004986`*^9, 3.8697600560788774`*^9}, {
   3.8699146011122513`*^9, 3.8699146041665783`*^9}, {3.869914671874372*^9, 
   3.869914691984473*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"2e3ca413-5f31-4f1f-8f0a-71844ac5b1f3"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "G", " ", "\[Gamma]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Theta]", "[", "1", "]"}], "-", 
     RowBox[{"\[Theta]", "[", "2", "]"}]}], ")"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], " ", "G", " ", "\[Gamma]"}], "+", 
   RowBox[{"m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "G", " ", "\[Gamma]"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{{3.8606813178043623`*^9, 3.860681336035321*^9}, 
   3.860682443729474*^9, 3.860682512960472*^9, 3.862478016662269*^9, 
   3.8624821283324614`*^9, 3.8649070449827433`*^9, 3.864907311864477*^9, 
   3.867771442450735*^9, 3.8691502238876133`*^9, 3.869150355783548*^9, 
   3.8691503967574253`*^9, 3.8691505741659603`*^9, 3.869150871567102*^9, 
   3.8691539215452776`*^9, 3.869156211397738*^9, 3.869157120691888*^9, 
   3.869157218399937*^9, {3.86915790423128*^9, 3.8691579303776455`*^9}, 
   3.8691586473508296`*^9, {3.8692320402643137`*^9, 3.869232082489585*^9}, 
   3.8692322821312957`*^9, 3.869233221324935*^9, 3.8692334681459103`*^9, 
   3.869234130395893*^9, 3.8697599666072035`*^9, 3.869760008720087*^9, {
   3.8697600407252264`*^9, 3.8697600569747367`*^9}, 3.869770295004822*^9, 
   3.8699145386938972`*^9, {3.869914579408099*^9, 3.869914605180834*^9}, 
   3.869914692368835*^9, 3.869923629061446*^9, 3.869935749704859*^9, 
   3.8699376243801804`*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"c848a294-bf4e-43fc-8999-3e0baf564edd"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1141.2, 604.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> True}, "TryRealOnly" -> False},
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"028973d0-41d4-492d-a2ef-b70d46e6ccd0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 349, 7, 160, "Title",ExpressionUUID->"9fd47ff8-23e8-4fee-8d63-6ad50fb11b65"],
Cell[932, 31, 181, 3, 53, "Subtitle",ExpressionUUID->"515c3e0d-bdbb-41be-9903-20defaec964b"],
Cell[1116, 36, 797, 14, 150, "Text",ExpressionUUID->"cfa925de-fe8c-451c-aaf7-3e4bc38e58fa"],
Cell[1916, 52, 2711, 52, 130, "Text",ExpressionUUID->"254cb9f0-9f41-4c78-93a0-b34b7a6b8b5d"],
Cell[4630, 106, 1868, 43, 45, "Input",ExpressionUUID->"40d681a2-6b4c-4f2a-b5d7-f3ffdd2769e8"],
Cell[6501, 151, 2102, 53, 55, "Input",ExpressionUUID->"c8f43902-dda2-4dd1-b319-d63dae6331ec"],
Cell[CellGroupData[{
Cell[8628, 208, 221, 4, 67, "Section",ExpressionUUID->"81bcf081-6355-4cf9-8d2e-f634bfc51f17"],
Cell[8852, 214, 346, 7, 35, "Text",ExpressionUUID->"a3a3a949-8420-446e-a301-f42b1134f568"],
Cell[9201, 223, 542, 14, 31, "Input",ExpressionUUID->"01ae6596-886c-4b48-9cf5-c0b6567875bc"],
Cell[9746, 239, 234, 6, 35, "Text",ExpressionUUID->"5cfab980-daf1-4896-bd63-5b9742ba2fe1"],
Cell[CellGroupData[{
Cell[10005, 249, 339, 7, 28, "Input",ExpressionUUID->"c52744b7-19c6-4746-b01e-8caa2c6df42d"],
Cell[10347, 258, 1240, 17, 32, "Output",ExpressionUUID->"8c2d4cca-10f4-4ed1-8ee2-b50f06db88c3"]
}, Open  ]],
Cell[11602, 278, 486, 9, 58, "Text",ExpressionUUID->"a32c60d2-01ba-4926-ae6b-e33d0ad3b588"],
Cell[12091, 289, 377, 8, 28, "Input",ExpressionUUID->"21974ee5-f777-45f3-9be2-531fad89523a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12505, 302, 275, 4, 67, "Section",ExpressionUUID->"b2f9a8bc-069e-4c54-9ae6-c2811fa3d8a4"],
Cell[12783, 308, 306, 7, 35, "Text",ExpressionUUID->"4d62278e-dcd7-4ffb-8e4f-3ee0c10f1eb6"],
Cell[13092, 317, 920, 26, 56, "Input",ExpressionUUID->"fd1bb678-260b-4f90-8244-3388e8f3e1b0"],
Cell[14015, 345, 1825, 44, 139, "Text",ExpressionUUID->"dbc9e4e5-eff9-43a2-98f1-0a8af786f0bf"],
Cell[15843, 391, 2694, 67, 134, "Text",ExpressionUUID->"ec8c6608-19f2-4dc3-b386-7e0e41188392"],
Cell[18540, 460, 2205, 55, 90, "Text",ExpressionUUID->"4122ba44-c0ba-4da0-a20f-e54447dde248"],
Cell[CellGroupData[{
Cell[20770, 519, 172, 3, 54, "Subsection",ExpressionUUID->"a40212d4-f35a-4379-8d76-d8d99f23eab0"],
Cell[20945, 524, 302, 6, 35, "Text",ExpressionUUID->"cc9004f2-343d-4925-a729-24c81a5fb54f"],
Cell[CellGroupData[{
Cell[21272, 534, 2545, 52, 31, "Input",ExpressionUUID->"6d390819-e168-4c4e-afa0-27bf571d47fb"],
Cell[23820, 588, 2346, 35, 32, "Output",ExpressionUUID->"8cc114ac-65ca-418a-beb6-97783ab41d1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26203, 628, 3009, 59, 50, "Input",ExpressionUUID->"04333801-dc11-460d-9dca-105eec94b88c"],
Cell[29215, 689, 3268, 63, 48, "Output",ExpressionUUID->"52df1fb4-cc3f-43eb-86e6-c103151cd4d4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32520, 757, 2120, 47, 50, "Input",ExpressionUUID->"5e7c6e71-8be9-4a36-b742-f8ced53719c4"],
Cell[34643, 806, 2219, 48, 48, "Output",ExpressionUUID->"1a213e3b-bdec-4880-8865-1013680753a7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36911, 860, 168, 3, 54, "Subsection",ExpressionUUID->"0830dce7-ddbc-4ce6-8ac1-78508e617ae3"],
Cell[37082, 865, 2884, 77, 122, "Text",ExpressionUUID->"e11d214a-2722-458a-bb19-7f50ee5eeec6"],
Cell[CellGroupData[{
Cell[39991, 946, 2039, 45, 31, "Input",ExpressionUUID->"7563f4e0-4622-4ec1-807a-f3dbff4af3c4"],
Cell[42033, 993, 1973, 29, 32, "Output",ExpressionUUID->"4650cf4c-e6ce-4a14-8f09-54b8deb57430"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44043, 1027, 2444, 53, 31, "Input",ExpressionUUID->"cfbe3205-2c15-471a-8dc4-4c4bab0d6bbb"],
Cell[46490, 1082, 2755, 50, 48, "Output",ExpressionUUID->"6650ed04-98a8-430d-8ad0-ba585a3fe726"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49282, 1137, 1913, 45, 31, "Input",ExpressionUUID->"c19c3c1d-32b3-49e0-91c1-afff4622a5e7"],
Cell[51198, 1184, 2695, 48, 48, "Output",ExpressionUUID->"49d09dd9-7ea0-4f31-b7ed-91e45853ae9e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53942, 1238, 259, 4, 54, "Subsection",ExpressionUUID->"0e581a85-53b7-459f-b760-c30f0b167eff"],
Cell[54204, 1244, 183, 3, 35, "Text",ExpressionUUID->"99eb0de2-566c-4876-831b-0a87ce8c88eb"],
Cell[54390, 1249, 2664, 66, 87, "Input",ExpressionUUID->"c8a67f98-e546-4008-b870-0c7334a12b20"],
Cell[CellGroupData[{
Cell[57079, 1319, 364, 8, 28, "Input",ExpressionUUID->"c0f6af99-3d04-4f80-831f-a040330449a3"],
Cell[57446, 1329, 1331, 26, 32, "Output",ExpressionUUID->"d7d9db62-8e6e-4ff4-a041-8d1692fac34d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58814, 1360, 290, 7, 28, "Input",ExpressionUUID->"def35405-e5e3-4e82-b220-bd15e8dcd81f"],
Cell[59107, 1369, 473, 14, 32, "Output",ExpressionUUID->"d9084b66-cfb2-49f6-af2d-84470b923806"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59641, 1390, 154, 3, 67, "Section",ExpressionUUID->"24526be6-f3bd-4f8a-9c9b-35d9772bcde7"],
Cell[59798, 1395, 847, 23, 39, "Text",ExpressionUUID->"317157d1-dc81-47bf-984b-a2d1835b9a0e"],
Cell[60648, 1420, 522, 14, 31, "Input",ExpressionUUID->"e6deb151-7301-41b0-bd64-9346fba5dfff"],
Cell[61173, 1436, 300, 6, 35, "Text",ExpressionUUID->"de41c51d-d8b4-4513-833e-eb8c922fc3e2"],
Cell[61476, 1444, 1822, 43, 31, "Input",ExpressionUUID->"1187aa29-b908-4dda-93a7-7ecd604c93c1"],
Cell[CellGroupData[{
Cell[63323, 1491, 570, 13, 48, "Input",ExpressionUUID->"a6f6d314-b47e-4b3c-a9fe-dac0c2dbedbc"],
Cell[63896, 1506, 1608, 32, 52, "Output",ExpressionUUID->"bf957891-6191-4e21-8d68-b7007c90816b"]
}, Open  ]],
Cell[65519, 1541, 184, 3, 35, "Text",ExpressionUUID->"751a9c22-66cf-47f1-a437-6e038df794ec"],
Cell[65706, 1546, 1728, 44, 49, "Input",ExpressionUUID->"9553856d-b294-49d4-9f47-f9b21a8b518b"],
Cell[CellGroupData[{
Cell[67459, 1594, 225, 4, 28, "Input",ExpressionUUID->"1931cd6f-1ea6-4b8d-97b8-9756dd6b7bed"],
Cell[67687, 1600, 1558, 35, 32, "Output",ExpressionUUID->"c19f8c1b-f943-4d61-8fe7-0442a6fe9a69"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69282, 1640, 227, 4, 28, "Input",ExpressionUUID->"721607fb-305f-4165-8fc6-da3a570dc769"],
Cell[69512, 1646, 813, 24, 32, "Output",ExpressionUUID->"5cae3daa-5b8b-4e8f-afef-fbf16b0d0e70"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70362, 1675, 159, 3, 54, "Subsection",ExpressionUUID->"4987b84b-f731-4b72-a9df-e4b1c0ea87be"],
Cell[CellGroupData[{
Cell[70546, 1682, 979, 28, 28, "Input",ExpressionUUID->"2cd31178-0853-4289-a5e4-7cc4542ec860"],
Cell[71528, 1712, 3806, 99, 51, "Output",ExpressionUUID->"e48aeaa0-4112-4cfe-8d3b-9be7c1c3587e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75371, 1816, 825, 21, 28, "Input",ExpressionUUID->"2e3ca413-5f31-4f1f-8f0a-71844ac5b1f3"],
Cell[76199, 1839, 1500, 29, 51, "Output",ExpressionUUID->"c848a294-bf4e-43fc-8999-3e0baf564edd"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

